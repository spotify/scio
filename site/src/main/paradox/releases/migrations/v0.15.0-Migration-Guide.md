# Scio v0.15.0

## AvroType macro deprecated

Please migrate to the appropriate magnolify-based API instead.

Ensure you can derive a `magnolify.avro.AvroType[T]`.
Use `sc.typedAvroFileMagnolify(path)` for reads and `scoll.saveAsAvroFile(path)` for writes. 

## BigQueryType macro deprecated

Please migrate to the appropriate magnolify-based API instead.

Ensure you can derive a `magnolify.bigquery.TableRowType[T]`.

For reads, use one of:
* `sc.typedBigQuerySelect(query)`
* `sc.typedBigQueryTable(table)`
* `sc.typedBigQueryStorageMagnolify(query)`
* `sc.typedBigQueryStorageMagnolify(table)`

For writes, use `scoll.saveAsBigQueryTable(table)`.

## Annoy removed

Annoy has been removed; use the @ref:[Voyager API](../../extras/Voyager.md) instead.

## ProtobufIO

For standard (non-typed) protobuf reads and writes, the default parameters have moved from `ProtobufIO` to `ProtobufObjectFileIO`.

```diff
- .saveAsProtobufFile(out, suffix = ProtobufIO.WriteParam.DefaultSuffixProtobuf)
+ .saveAsProtobufFile(out, suffix = ProtobufTypedObjectFileIO.WriteParam.DefaultSuffixProtobuf)
```

## Sparkey `map`, `asSparkey` removed

Mapping over a sparkey side input with `map` proved to be so inefficient that this method has been removed. Map individual elements as necessary instead.

`asSparkey` has been removed, use `saveAsSparkey` instead.

## Bigtable constructors

Due to scala language limitations, calling the `bigtable` method with default values (`bigtable(project, instance, table, (keyRanges=...|rowFilter=...|maxBufferElementCount=...))`) is no longer supported. Instead, you will need to call the variant with BigTableOptions; you can use `BTOptions(projectId, instanceId)` as a shorthand instead of the more-verbose builder. For example:

```diff
- .bigtable(projectId, instanceId, tableId, rowFilter = rowFilter)
+ .bigtable(BTOptions(projectId, instanceId), tableId, rowFilter = rowFilter)
```

## tensorflow upgraded to 1.0.0

Tensorflow has been upgraded to 1.0.0. The tensorflow types have moved from package `org.tensorflow.proto.example` to `org.tensorflow.proto`:

```diff
- import org.tensorflow.proto.example.BytesList
- import org.tensorflow.proto.example.Example
- import org.tensorflow.proto.example.Feature
- import org.tensorflow.proto.example.FloatList
- import org.tensorflow.proto.example.Int64List
+ import org.tensorflow.proto.BytesList
+ import org.tensorflow.proto.Example
+ import org.tensorflow.proto.Feature
+ import org.tensorflow.proto.FloatList
+ import org.tensorflow.proto.Int64List
```
